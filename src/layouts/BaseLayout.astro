---
type Props = {
  title: string;
  description: string;
  canonical?: string;
  ogImage?: string;
};

const { title, description, canonical, ogImage } = Astro.props;

const site = Astro.site?.toString().replace(/\/$/, "") ?? "";
const currentUrl = new URL(Astro.url.pathname, site || Astro.url.origin).toString();
const canonicalUrl = canonical ?? currentUrl;
const og = ogImage
  ? (ogImage.startsWith("http") ? ogImage : new URL(ogImage, site || Astro.url.origin).toString())
  : undefined;
---

<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalUrl} />

    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalUrl} />
    {og ? <meta property="og:image" content={og} /> : null}

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    {og ? <meta name="twitter:image" content={og} /> : null}

    <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml" />
  </head>
  <body>
    <main style="max-width: 820px; margin: 40px auto; padding: 0 16px;">
      <slot />
    </main>
  </body>
</html>
